load_all()
load_all()
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Moduel")
return(kegg.df)
anno.KEGG <- eggno |>
dplyr::filter(KEGG_Module != "-") |>
dplyr::select(Gene, KEGG_ko, KEGG_Module) |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Module = gsub("ko", "map", KEGG_Module)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
return(anno.KEGG)
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
anno.KEGG <- anno.KEGG |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
anno.KEGG <- anno.KEGG |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= anno.KEGG |> dplyr::select(pathway, Gene),
TERM2NAME = anno.KEGG |> dplyr::select(pathway, name)
)
)
}
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
library(magrittr)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
return(kegg.df)
anno.KEGG <- eggno |>
dplyr::filter(KEGG_Module != "-") |>
dplyr::select(Gene, KEGG_ko, KEGG_Module) |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Module = gsub("ko", "map", KEGG_Module)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
return(anno.KEGG)
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
anno.KEGG <- anno.KEGG |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
anno.KEGG <- anno.KEGG |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= anno.KEGG |> dplyr::select(pathway, Gene),
TERM2NAME = anno.KEGG |> dplyr::select(pathway, name)
)
)
}
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
load_all(0)
load_all()
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
library(magrittr)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
return(kegg.df)
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
anno.KEGG <- anno.KEGG |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
anno.KEGG <- anno.KEGG |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= anno.KEGG |> dplyr::select(pathway, Gene),
TERM2NAME = anno.KEGG |> dplyr::select(pathway, name)
)
)
}
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
library(magrittr)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
moduel.all <- kegg_list('Module')
colnames(moduel.all) <- c("Module", "name")
return(moduel.all)
if (!is.null(species)) {
anno.KEGG <- anno.KEGG |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
anno.KEGG <- anno.KEGG |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= anno.KEGG |> dplyr::select(pathway, Gene),
TERM2NAME = anno.KEGG |> dplyr::select(pathway, name)
)
)
}
parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
s <- parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
View(s)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
moduel.all <- kegg_list('Module')
colnames(moduel.all) <- c("Module", "name")
kegg.df <- kegg.df |>
dplyr::left_join(moduel.all, by = "Module") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(Module, Gene),
TERM2NAME = kegg.df |> dplyr::select(Module, name)
)
)
}
s <- parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
s
library(magrittr)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
moduel.all <- kegg_list('Module') |> dplyr::distinct()
colnames(moduel.all) <- c("Module", "name")
kegg.df <- kegg.df |>
dplyr::left_join(moduel.all, by = "Module") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(Module, Gene),
TERM2NAME = kegg.df |> dplyr::select(Module, name)
)
)
}
s <- parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
s
library(magrittr)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
return(kegg.df)
moduel.all <- kegg_list('Module') |> dplyr::distinct()
colnames(moduel.all) <- c("Module", "name")
kegg.df <- kegg.df |>
dplyr::left_join(moduel.all, by = "Module") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(Module, Gene),
TERM2NAME = kegg.df |> dplyr::select(Module, name)
)
)
}
s <- parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
View(s)
library(magrittr)
parse.eggNOG.KEGGM <- function(eggNOG.file , ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Module")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Module=stringr::str_split(KEGG_Module, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Module) |>
dplyr::distinct() |>
dplyr::ungroup()
moduel.all <- kegg_list('Module')
colnames(moduel.all) <- c("Module", "name")
kegg.df <- kegg.df |>
dplyr::left_join(moduel.all, by = "Module") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(Module, Gene),
TERM2NAME = kegg.df |> dplyr::select(Module, name) |> dplyr::distinct()
)
)
}
s <- parse.eggNOG.KEGGM("test_data/out.emapper.annotations")
s
library(magrittr)
parse.eggNOG.KEGG <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Pathway")
kegg.df <- kegg.df |>
dplyr::filter(KEGG_Pathway != "-") |>
dplyr::select(Gene, KEGG_ko, KEGG_Pathway) |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Pathway = gsub("ko", "map", KEGG_Pathway)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
pathway=stringr::str_split(KEGG_Pathway, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(pathway) |>
dplyr::distinct() |>
dplyr::ungroup()
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
kegg.df <- kegg.df |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= anno.KEGG |> dplyr::select(pathway, Gene),
TERM2NAME = anno.KEGG |> dplyr::select(pathway, name) |> dplyr::distinct()
)
)
}
parse.eggNOG.KEGG("test_data/out.emapper.annotations")
parse.eggNOG.KEGG("test_data/out.emapper.annotations")
parse.eggNOG.KEGG <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Pathway")
kegg.df <- kegg.df |>
dplyr::filter(KEGG_Pathway != "-") |>
dplyr::select(Gene, KEGG_ko, KEGG_Pathway) |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Pathway = gsub("ko", "map", KEGG_Pathway)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
pathway=stringr::str_split(KEGG_Pathway, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(pathway) |>
dplyr::distinct() |>
dplyr::ungroup()
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
kegg.df <- kegg.df |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(pathway, Gene),
TERM2NAME = kegg.df |> dplyr::select(pathway, name) |> dplyr::distinct()
)
)
}
parse.eggNOG.KEGG("test_data/out.emapper.annotations")
parse.eggNOG.KEGG <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Pathway")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Pathway = gsub("ko", "map", KEGG_Pathway)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
pathway=stringr::str_split(KEGG_Pathway, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(pathway) |>
dplyr::distinct() |>
dplyr::ungroup()
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
kegg.df <- kegg.df |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(pathway, Gene),
TERM2NAME = kegg.df |> dplyr::select(pathway, name) |> dplyr::distinct()
)
)
}
parse.eggNOG.KEGGP <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Pathway")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Pathway = gsub("ko", "map", KEGG_Pathway)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
pathway=stringr::str_split(KEGG_Pathway, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(pathway) |>
dplyr::distinct() |>
dplyr::ungroup()
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
kegg.df <- kegg.df |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(pathway, Gene),
TERM2NAME = kegg.df |> dplyr::select(pathway, name) |> dplyr::distinct()
)
)
}
parse.eggNOG.KEGGP("test_data/out.emapper.annotations")
parse.eggNOG.KEGGP("test_data/out.emapper.annotations", "bamy")
parse.eggNOG.KEGGP <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Pathway")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko),
KEGG_Pathway = gsub("ko", "map", KEGG_Pathway)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
pathway=stringr::str_split(KEGG_Pathway, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(pathway) |>
dplyr::distinct() |>
dplyr::ungroup()
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
kegg.df <- kegg.df |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(pathway, Gene),
TERM2NAME = kegg.df |> dplyr::select(pathway, name) |> dplyr::distinct()
)
)
}
use_r("parse_GO")
use_r("parse_KEGGR")
use_r("parse_KEGGP")
use_r("parse_KEGGR")
use_r("parse_KEGGM")
parse.eggNOG.KEGGR <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Reaction")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Reaction=stringr::str_split(KEGG_Reaction, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Reaction) |>
dplyr::distinct() |>
dplyr::ungroup()
return(kegg.df)
pathway.all <- kegg_list('pathway', species = species)
colnames(pathway.all) <- c("pathway", "name")
if (!is.null(species)) {
kegg.df <- kegg.df |>
dplyr::mutate(pathway = sub("^[a-zA-Z]+", species, pathway)) |>
dplyr::filter(pathway %in% pathway.all[["pathway"]])
}
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "pathway") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(pathway, Gene)  |> dplyr::distinct()
TERM2NAME = kegg.df |> dplyr::select(pathway, name) |> dplyr::distinct()
parse.eggNOG.KEGGR <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Reaction")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Reaction=stringr::str_split(KEGG_Reaction, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Reaction) |>
dplyr::distinct() |>
dplyr::ungroup()
return(kegg.df)
}
parse.eggNOG.KEGGR
parse.eggNOG.KEGGR("test_data/out.emapper.annotations")
kegg_list("Reaction")
parse.eggNOG.KEGGR("./test_data/out.emapper.annotations")
parse.eggNOG.KEGGR <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Reaction")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Reaction=stringr::str_split(KEGG_Reaction, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Reaction) |>
dplyr::distinct() |>
dplyr::ungroup()
reaction.all <- kegg_list('Reaction')
colnames(reaction.all) <- c("Reaction", "name")
kegg.df <- kegg.df |>
dplyr::left_join(pathway.all, by = "Reaction") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(Reaction, Gene)  |> dplyr::distinct(),
TERM2NAME = kegg.df |> dplyr::select(Reaction, name) |> dplyr::distinct()
)
)
}
parse.eggNOG.KEGGR("./test_data/out.emapper.annotations")
parse.eggNOG.KEGGR <- function(eggNOG.file, species = NULL, ...) {
eggno <-load.eggNOG(eggNOG.file, ...)
kegg.df <- get.KEGG.annotation(eggno, use = "Reaction")
kegg.df <- kegg.df |>
dplyr::mutate(KEGG_ko = gsub("ko:", "", KEGG_ko)) |>
dplyr::group_by(Gene) |>
dplyr::summarise(KO=stringr::str_split(KEGG_ko, ","),
Reaction=stringr::str_split(KEGG_Reaction, ",")) |>
tidyr::unnest(KO) |>
tidyr::unnest(Reaction) |>
dplyr::distinct() |>
dplyr::ungroup()
reaction.all <- kegg_list('Reaction')
colnames(reaction.all) <- c("Reaction", "name")
kegg.df <- kegg.df |>
dplyr::left_join(reaction.all, by = "Reaction") |>
tidyr::drop_na()
return(
list(
TERM2GENE= kegg.df |> dplyr::select(Reaction, Gene)  |> dplyr::distinct(),
TERM2NAME = kegg.df |> dplyr::select(Reaction, name) |> dplyr::distinct()
)
)
}
parse.eggNOG.KEGGR("./test_data/out.emapper.annotations")
